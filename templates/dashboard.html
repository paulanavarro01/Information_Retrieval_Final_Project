{% extends "base.html" %}
{% block page_title %}{{ page_title }}{% endblock %}

{% block header %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
{% endblock %}

{% block content %}
<div class="container py-5" style="max-width: 1200px; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;">
    
    <div class="text-center mb-5 p-5 rounded-4 shadow-lg" style="background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 50%, #0284c7 100%); color: white;">
        <h1 class="display-4 fw-bold mb-2">üìà Dashboard Statistics</h1>
        <p class="lead opacity-90 mb-0">Analytics & Insights Overview</p>
    </div>

    <div class="row g-4 mb-5">
        <div class="col-lg-6">
            <div class="chart-card h-100 rounded-4 shadow-xl overflow-hidden" style="background: linear-gradient(135deg, #e0f2fe 0%, #bfdbfe 100%); border: 1px solid #bae6fd;">
                <div class="chart-header p-4 text-white fw-bold rounded-top-4" style="background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%); font-size: 1.2rem;">
                    üî• Top 10 Most Clicked Products
                </div>
                <div class="p-4 bg-white">
                    <canvas id="topDocsChart" style="height: 400px;"></canvas>
                </div>
            </div>
        </div>

        <div class="col-lg-6">
            <div class="chart-card h-100 rounded-4 shadow-xl overflow-hidden" style="background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%); border: 1px solid #86efac;">
                <div class="chart-header p-4 text-white fw-bold rounded-top-4" style="background: linear-gradient(135deg, #14b8a6 0%, #0d9488 100%); font-size: 1.2rem;">
                    üîç Top 10 Search Queries
                </div>
                <div class="p-4 bg-white">
                    <canvas id="topQueriesChart" style="height: 400px;"></canvas>
                </div>
            </div>
        </div>
    </div>

    <div class="row g-4">
        <div class="col-12">
            <div class="chart-card rounded-4 shadow-xl overflow-hidden" style="background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); border: 1px solid #fcd34d;">
                <div class="chart-header p-4 text-white fw-bold rounded-top-4" style="background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); font-size: 1.2rem;">
                    ‚≠ê Rating Distribution
                </div>
                <div class="p-4 bg-white">
                    <canvas id="ratingChart" style="height: 400px;"></canvas>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.stats-card:hover {
    transform: translateY(-8px) scale(1.02) !important;
    box-shadow: 0 25px 50px rgba(0,0,0,0.2) !important;
}

.chart-card {
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}

.chart-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 20px 40px rgba(0,0,0,0.15) !important;
}

.chart-header {
    border-top-left-radius: 16px !important;
    border-top-right-radius: 16px !important;
}

.shadow-xl {
    box-shadow: 0 20px 60px rgba(0,0,0,0.15) !important;
}
</style>

<script>
const topDocsCtx = document.getElementById('topDocsChart').getContext('2d');
new Chart(topDocsCtx, {
    type: 'bar',
    data: { labels: {{ top_docs_labels|safe }}, datasets: [{ label: 'Clicks', data: {{ top_docs_counts|safe }}, backgroundColor: 'rgba(54, 162, 235, 0.7)', borderColor: 'rgba(54, 162, 235, 1)', borderWidth: 1 }]},
    options: { responsive: true, plugins: { legend: { display: false } }, scales: { y: { beginAtZero: true } } }
});

const topQueriesCtx = document.getElementById('topQueriesChart').getContext('2d');
new Chart(topQueriesCtx, {
    type: 'bar',
    data: { labels: {{ top_queries_labels|safe }}, datasets: [{ label: 'Searches', data: {{ top_queries_counts|safe }}, backgroundColor: 'rgba(75, 192, 192, 0.7)', borderColor: 'rgba(75, 192, 192, 1)', borderWidth: 1 }]},
    options: { responsive: true, plugins: { legend: { display: false } }, scales: { y: { beginAtZero: true } } }
});

const ratingCtx = document.getElementById('ratingChart').getContext('2d');
new Chart(ratingCtx, {
    type: 'bar',
    data: { labels: {{ rating_labels|safe }}, datasets: [{ label: 'Number of Products per Rating', data: {{ rating_counts|safe }}, backgroundColor: 'rgba(255, 159, 64, 0.7)', borderColor: 'rgba(255, 159, 64, 1)', borderWidth: 1 }]},
    options: { responsive: true, plugins: { legend: { display: false } }, scales: { y: { beginAtZero: true } } }
});
</script>
{% endblock %}
