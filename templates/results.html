{% extends "base.html" %}
{% block page_title %}{{ page_title }}{% endblock %}

{% block content %}
<div class="container py-5">
    <h3 class="mb-4 text-center fw-bold" style="color: #2563eb;">Search Results</h3>
    <p class="text-muted text-center mb-4" style="background: #e0f2fe; padding: 15px; border-radius: 10px;">
        Found <strong style="color: #14b8a6;">{{ found_counter }}</strong> results for 
        "<em style="color: #f59e0b;">{{ search_query }}</em>"
    </p>

    {% if rag_response %}
    <div class="alert alert-info shadow-sm mb-4" style="background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%); border: none; border-radius: 15px;">
        <h5 class="fw-bold" style="color: #0284c7;">ðŸ¤– AI-Generated Summary</h5>
        <p style="color: #1e40af;">{{ rag_response }}</p>
    </div>
    {% endif %}

    <div class="d-flex flex-column g-4" style="max-width: 600px; margin: 0 auto;">
        {% for item in results_list %}
        <div class="card shadow-sm hover-shadow rounded-4 h-100" style="background: #ffffff; border: 1px solid #e2e8f0; transition: all 0.3s ease;">
            <div class="d-flex g-3 p-4" style="align-items: center;">
                {% if item.images and item.images[0] %}
                <div style="flex-shrink: 0; width: 100px; height: 100px; background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%); border-radius: 12px; display: flex; align-items: center; justify-content: center; margin-right: 20px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
                    <img src="{{ item.images[0] }}" class="img-fluid rounded" style="max-height:90px; max-width:90px; object-fit:contain;" alt="{{ item.title }}">
                </div>
                {% endif %}
                
                <div class="flex-grow-1">
                    <div class="d-flex justify-content-between align-items-start mb-2">
                        <h5 class="card-title mb-0 fw-bold" style="color: #1e293b; font-size: 1.1rem; line-height: 1.3;">
                            <a href="{{ item.url }}" class="text-decoration-none" style="color: #2563eb;">{{ item.title }}</a>
                        </h5>
                        
                        {% if item.selling_price %}
                        <p class="mb-0 fw-bold fs-5">
                            {% if item.discount %}
                                <span class="text-decoration-line-through text-muted">â‚¹{{ item.actual_price }}</span>
                                <span class="text-danger fw-bold">â‚¹{{ item.selling_price }} ({{ item.discount }}% off)</span>
                            {% else %}
                                â‚¹{{ item.selling_price }}
                            {% endif %}
                        </p>
                        {% endif %}


                    </div>
                    
                    {% if item.brand %}
                    <p class="text-muted small mb-2" style="color: #64748b;">{{ item.brand }}{% if item.category %} â€¢ {{ item.category }}{% endif %}</p>
                    {% endif %}
                    
                    {% if item.description %}
                    <p class="card-text mb-0" style="font-size: 0.9rem; color: #475569; line-height: 1.5;">
                        {% set words = item.description.split()[:25] %}
                        {% set query_words = search_query.lower().split() %}
                        {% for w in words %}
                            {% if w|lower in query_words %}
                                <strong style="color: #f59e0b;">{{ w }}</strong>
                            {% else %}
                                {{ w }}
                            {% endif %}
                            {% if not loop.last %} {% endif %}
                        {% endfor %}...
                    </p>
                    {% endif %}
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</div>

<style>
.hover-shadow:hover {
    box-shadow: 0 8px 25px rgba(0,0,0,0.15) !important;
    transform: translateY(-4px);
    border-color: #3b82f6 !important;
}
.card {
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}
</style>
{% endblock %}
